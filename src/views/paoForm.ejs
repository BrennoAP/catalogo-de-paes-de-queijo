<%- include('partials/header', { title: 'Novo cadastro' }) %>

<body class="container py-4">
  <% if (mensagem) { %>
  <div class="alert alert-info alert-dismissible fade show" role="alert">
    <%= mensagem %>
    <button
      type="button"
      class="btn-close"
      data-bs-dismiss="alert"
      aria-label="Close"
    ></button>
  </div>
  <% } %>

  <h1 class="mb-4">Cadastrar Novo Pão</h1>

  <!-- Formulário de novo pão -->
  <form action="/create" method="POST" enctype="multipart/form-data">
    <div class="mb-3">
      <label for="name" class="form-label">Nome do Pão</label>
      <input type="text" class="form-control" name="name" id="name" required />
    </div>

    <div class="mb-3">
      <label for="preco" class="form-label">Preço</label>
      <input
        type="number"
        step="0.01"
        class="form-control"
        name="preco"
        id="preco"
        required
      />
    </div>

    <div class="mb-3">
      <label for="textura" class="form-label">Textura</label>
      <input
        type="text"
        class="form-control"
        name="textura"
        id="textura"
        required
      />
    </div>

    <div class="mb-3">
      <label for="descricao" class="form-label">Descrição</label>
      <textarea
        class="form-control"
        name="descricao"
        id="descricao"
        rows="3"
      ></textarea>
    </div>

    <div class="mb-3">
      <label for="foto" class="form-label">Foto</label>
      <input type="file" class="form-control" name="foto" id="foto" />
    </div>

    <!-- Select de padaria -->
    <div class="mb-3">
      <label for="padariaSelect" class="form-label">Padaria</label>
      <div class="input-group">
        <select
          id="padariaSelect"
          name="padariaId"
          class="form-select"
          required
        >
          <% padarias.forEach(p => { %>
          <option value="<%= p.id %>"><%= p.name %> - <%= p.endereco %></option>
          <% }) %>
        </select>
        <button
          type="button"
          class="btn btn-outline-primary"
          data-bs-toggle="modal"
          data-bs-target="#novaPadariaModal"
        >
          + Nova Padaria
        </button>
      </div>
    </div>

    <button type="submit" class="btn btn-success">Salvar Pão</button>
  </form>

  <!-- Modal Nova Padaria -->
  <div class="modal fade" id="novaPadariaModal" tabindex="-1">
    <div class="modal-dialog">
      <form id="novaPadariaForm" class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title">Cadastrar Padaria</h5>
          <button
            type="button"
            class="btn-close"
            data-bs-dismiss="modal"
          ></button>
        </div>
        <div class="modal-body">
          <input
            type="text"
            class="form-control mb-2"
            name="name"
            placeholder="Nome da padaria"
            required
          />
          <input
            type="text"
            class="form-control"
            name="endereco"
            placeholder="Endereço"
            required
          />
        </div>
        <div class="modal-footer">
          <button type="submit" class="btn btn-primary">Salvar</button>
        </div>
      </form>
    </div>
  </div>

  <!-- script pra retornar alerta ao salvar o pao e para cadastrar uma nova padaria no modal -->
  <script type="module" src="/js-scripts/cadastrarPao.js"></script>
  <script type="module" src="/js-scripts/novaPadariaModal.js"></script>
</body>

<%- include('partials/footer') %>
